<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSBC AI-Agent: Global Guardian (Ms. Li)</title>
    <style>
        /* --- Core Visual Variables (HSBC Theme) --- */
        :root {
            --hsbc-red: #db0011;
            --hsbc-black: #2d2d2d;
            --hsbc-gray: #f4f4f4;
            --hsbc-white: #ffffff;
            --text-primary: #333333;
            --text-secondary: #666666;
            --accent-green: #008a3c;
            --accent-gold: #c6a87c;
            --bg-dark: #1e1e1e;
            --app-bg: #f5f5f7;
        }

        body {
            margin: 0; padding: 0;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
            background-color: var(--bg-dark);
            color: #cccccc;
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- Left: Governance View --- */
        .story-panel {
            width: 55%;
            padding: 40px 40px 100px 40px;
            border-right: 1px solid #333;
            overflow-y: auto;
            background: var(--bg-dark);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .header-title {
            font-size: 1.4rem; color: #fff; 
            border-bottom: 2px solid var(--hsbc-red); padding-bottom: 15px; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .header-badge { font-size: 0.7rem; background: #333; padding: 4px 8px; border-radius: 4px; color: var(--accent-gold); border: 1px solid var(--accent-gold); letter-spacing: 1px;}

        .scene-card {
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid #444;
            padding: 20px;
            border-radius: 0 8px 8px 0;
            opacity: 0.3; transform: translateX(-10px);
            transition: all 0.6s ease;
        }

        .scene-card.active {
            opacity: 1; border-left-color: var(--hsbc-red);
            background: linear-gradient(90deg, rgba(219, 0, 17, 0.05) 0%, transparent 100%);
            transform: translateX(0);
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .scene-header { font-size: 0.75rem; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; display: flex; justify-content: space-between;}
        .scene-title { font-size: 1.1rem; font-weight: bold; color: #fff; margin-bottom: 10px; }
        .scene-desc { font-size: 0.95rem; color: #bbb; line-height: 1.5; margin-bottom: 15px; }

        .system-log {
            font-family: 'Fira Code', 'Monaco', monospace;
            font-size: 0.75rem; background: #111; padding: 15px;
            border-radius: 6px; border: 1px solid #333; color: #aaa;
            line-height: 1.4;
        }
        .term-val { color: var(--accent-green); }
        .term-key { color: #2196f3; }
        .term-alert { color: var(--hsbc-red); }

        /* --- Right: Phone Simulator (User View) --- */
        .device-stage {
            width: 45%;
            background: #e5e5e5;
            display: flex; justify-content: center; align-items: center;
            position: relative;
        }

        .phone-frame {
            width: 375px; height: 812px;
            background: #fff; border-radius: 45px;
            border: 8px solid #1a1a1a; position: relative; overflow: hidden;
            box-shadow: 0 30px 60px rgba(0,0,0,0.2);
        }
        .notch { position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 160px; height: 32px; background: #1a1a1a; border-radius: 0 0 20px 20px; z-index: 999; }
        .status-bar { height: 44px; display: flex; justify-content: space-between; padding: 0 25px; align-items: center; font-size: 12px; font-weight: bold; color: #000; position: absolute; top:0; width: 100%; box-sizing: border-box; z-index: 900;}

        /* --- Screens --- */
        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: none; flex-direction: column;
            background: var(--app-bg); animation: fadeIn 0.4s ease;
        }
        .screen.active { display: flex; }

        /* Notification */
        .clean-notification {
            position: absolute; top: -140px; left: 10px; right: 10px;
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 14px; padding: 15px; z-index: 2000;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15); border: 1px solid #f0f0f0;
            display: flex; gap: 12px; cursor: pointer; transition: top 0.5s ease;
            max-height: 110px; overflow: hidden;
        }
        .clean-notification.show { top: 20px; }

        /* Chat Interface */
        .chat-app-header { 
            background: #fff; padding: 50px 20px 15px; border-bottom: 1px solid #eee; 
            display: flex; align-items: center; gap: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.02); z-index: 10; 
        }
        .rm-avatar { width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; }
        .rm-avatar img { width: 100%; height: 100%; object-fit: contain; }
        
        .chat-body-light { flex: 1; background: var(--app-bg); padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; padding-bottom: 150px; }
        
        .chat-input-bar { 
            position: absolute; bottom: 0; left: 0; right: 0; background: #fff; 
            padding: 10px 15px; border-top: 1px solid #e0e0e0; display: flex; align-items: center; gap: 10px; 
        }
        .chat-input-bar img { width: 28px; height: 28px; cursor: pointer; }
        .chat-input-field { 
            flex: 1; background: #f0f0f0; border-radius: 20px; padding: 12px 15px; 
            font-size: 0.95rem; color: #999; 
        }

        /* Bubbles */
        .bubble-light { max-width: 85%; padding: 12px 16px; border-radius: 18px; font-size: 0.95rem; line-height: 1.4; opacity: 0; transform: translateY(10px); animation: popUp 0.4s forwards; box-shadow: 0 1px 2px rgba(0,0,0,0.05); position: relative; z-index: 100; }
        .bubble-light.ai { align-self: flex-start; background: #ffffff; color: #333333; border-bottom-left-radius: 4px; border: 1px solid #e5e5e5; }
        .bubble-light.user { align-self: flex-end; background: var(--hsbc-black); color: white; border-bottom-right-radius: 4px; }
        
        @keyframes popUp { to { opacity: 1; transform: translateY(0); } }
        
        /* Widget: Transfer */
        .transfer-card {
            background: #fff; border: 1px solid #e0e0e0; border-radius: 12px; padding: 15px; margin-top: 5px;
        }
        .tc-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .tc-label { font-size: 0.75rem; color: #666; text-transform: uppercase; }
        .tc-amount { font-size: 1.2rem; font-weight: bold; color: #333; }
        .tc-arrow { text-align: center; color: var(--hsbc-red); margin: 5px 0; font-size: 1.2rem; }
        .tc-info { background: #f9f9f9; padding: 8px; border-radius: 6px; font-size: 0.75rem; color: #555; display: flex; justify-content: space-between; }
        .highlight-text { color: var(--accent-green); font-weight: bold; }
        
        /* Widget: Form Input */
        .form-card {
            background: #fff; border: 1px solid #e0e0e0; border-radius: 12px; padding: 15px; margin-top: 5px;
        }
        .form-header { font-weight: bold; font-size: 0.9rem; margin-bottom: 10px; color: #333; }
        .form-group { margin-bottom: 10px; }
        .form-label { font-size: 0.75rem; color: #666; margin-bottom: 4px; display: block; }
        .form-input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 0.85rem; box-sizing: border-box; background: #f9f9f9; }
        .form-check { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: #333; margin-top: 10px; }

        .btn-action { width: 100%; padding: 10px; background: var(--hsbc-red); color: white; border: none; border-radius: 6px; margin-top: 10px; font-weight: bold; cursor: pointer; }

        /* Face ID */
        .faceid-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.95); display: none;
            flex-direction: column; justify-content: center; align-items: center;
            z-index: 3000; backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        .faceid-overlay.show { display: flex; }
        .faceid-icon { width: 60px; height: 60px; margin-bottom: 20px; animation: pulse 2s infinite; opacity: 0.8;}
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* Controls */
        .control-bar { position: fixed; bottom: 0; left: 0; width: 55%; padding: 20px 0; background: var(--bg-dark); border-top: 1px solid #333; display: flex; justify-content: space-between; align-items: center; z-index: 5000; box-shadow: 0 -5px 20px rgba(0,0,0,0.2); }
        .next-btn { padding: 12px 30px; background: var(--accent-gold); color: #000; border: none; border-radius: 30px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 20px rgba(198, 168, 124, 0.4); font-size: 1rem; margin-right: 30px;}
        .next-btn:disabled { background: #444; color: #888; box-shadow: none; cursor: not-allowed; }
        .prev-btn { padding: 12px 30px; background: #666; color: #fff; border: none; border-radius: 30px; font-weight: bold; cursor: pointer; font-size: 1rem; margin-left: 30px; }
        .prev-btn:disabled { background: #333; color: #666; cursor: not-allowed; }

    </style>
</head>
<body>

<div class="story-panel" id="storyPanel">
    <div class="header-title">
        <span>HSBC Premier Family</span>
        <span class="header-badge">GLOBAL EDUCATION</span>
    </div>
</div>

<div class="device-stage">
    <div class="phone-frame">
        <div class="status-bar">
            <span>22:15</span>
            <span>China Mobile</span>
        </div>
        <div class="notch"></div>

        <div class="clean-notification" id="notif" onclick="userClicksNotification()">
            <div style="background:#00c853; width:40px; height:40px; border-radius:8px; display:flex; align-items:center; justify-content:center; color:white; font-size:24px;">
               üí¨
            </div>
            <div style="flex:1;">
                <div style="font-size:0.8rem; font-weight:bold; color:#000; display:flex; justify-content:space-between;">
                    <span>Leo (Son)</span> <span style="font-weight:normal; color:#888;">Now</span>
                </div>
                <div style="font-size:0.85rem; color:#333; margin-top:4px;">
                    Mom, emergency! Landlord needs deposit (¬£2,000) tonight or I lose the flat! üò≠
                </div>
            </div>
        </div>

        <div class="screen active" id="scr-chat">
            <div class="chat-app-header">
                <div class="rm-avatar">
                    <img src="resource/IMG_1035.png" alt="HSBC Logo" title="HSBC Logo">
                </div>
                <div>
                    <div style="font-weight:bold; font-size:0.9rem; color:#333;">Family Link</div>
                    <div style="font-size:0.7rem; color:#008a3c;">‚óè Global Guardian AI</div>
                </div>
            </div>
            <div class="chat-body-light" id="chatBody"></div>
            <div class="chat-input-bar">
                <img src="resource/photo.png" alt="Photo">
                <div class="chat-input-field">Type a message...</div>
                <img src="resource/jianpan.png" alt="Keyboard">
                <img src="resource/jiahao.png" alt="More">
            </div>
        </div>

        <div class="faceid-overlay" id="faceidOverlay">
            <img src="https://img.icons8.com/ios-filled/100/2d2d2d/face-id.png" class="faceid-icon" alt="FaceID">
            <div style="color:#333; font-size:1.1rem; font-weight:bold;">Face ID</div>
            <div style="color:#999; font-size:0.9rem; margin-top:5px;">Verifying Ms. Li</div>
        </div>

    </div>
</div>
    
<div class="control-bar">
    <button class="prev-btn" id="prevBtn" onclick="prevScene()" disabled>< Previous</button>
    <button class="next-btn" id="nextBtn" onclick="nextScene()">Start Scenario</button>
</div>

<script>
    const script = [
        {
            phase: "Scene 1: Emergency SOS",
            title: "Emergency Call from London",
            desc: "10:15 PM Shanghai. Ms. Li receives an urgent message from her son Leo. He needs money for rent deposit immediately, but the bank is closed.",
            log: `> External Trigger Event:
  - Source: WeChat
  - Sender: LEO_LI (Son)
  - Content: "Urgent Rent ¬£2000"
  - Time: 22:15 (CN) / 14:15 (UK)`,
            action: "show_notif"
        },
        {
            phase: "Scene 2: Identity Recognition",
            title: "Context Awareness",
            desc: "Ms. Li opens the HSBC App. AI detects late-night login + overseas child profile. AI explains GVGT transfer speed to her.",
            log: `> Context Engine:
  - User: Ms. Li (Premier)
  - Location: Shanghai (Late Night)
  - Prediction: Urgent Remittance
  - AI Response: GVGT Explanation`,
            action: "msg_welcome"
        },
        {
            phase: "Scene 3: Solution",
            title: "Instant Connectivity",
            desc: "AI displays GVGT transfer widget. Key features: Real-time + Zero Fees. Ms. Li executes transfer immediately.",
            log: `> Solution Matching:
  - Product: GVGT (Global Transfers)
  - Speed: <span class="term-val">Real-time</span>
  - Fee: <span class="term-val">0.00</span>
  - Auth: FACE_ID Verification`,
            action: "msg_solution"
        },
        {
            phase: "Scene 4: Pain Point Exposed",
            title: "Daily Life Friction",
            desc: "Transfer complete. Ms. Li raises an issue: Leo has no local card for tube/groceries. AI acknowledges this pain point.",
            log: `> User Feedback:
  - Pain Point: No Local Card
  - Need: Daily Spending Solution
  - Context: Cashless Society (UK)`,
            action: "msg_pain"
        },
        {
            phase: "Scene 5: Value-Added Upsell",
            title: "Supplementary Credit Card",
            desc: "AI recommends Premier Supplementary Credit Card. Highlights: Digital First (Apple Pay), Parental Control, Points Sharing.",
            log: `> Next Best Action:
  - Recommendation: Premier Supplementary Card
  - Benefits: Digital Card, Monitoring, Points
  - Compliance: Liability Disclosure`,
            action: "msg_upsell"
        },
        {
            phase: "Scene 6: Key Attraction",
            title: "Real-time Monitoring",
            desc: "Ms. Li likes 'Parental Control'. AI confirms real-time alerts and digital wallet usage (NFC). She decides to apply.",
            log: `> Value Proposition Accepted:
  - Trigger: Spending Transparency
  - Tech: NFC / Apple Pay Setup
  - Intent: Apply Immediately`,
            action: "msg_monitoring"
        },
        {
            phase: "Scene 7: Application Process",
            title: "Data Collection",
            desc: "AI collects necessary info: Phone, Address, Age Check. No income proof needed (linked to main account).",
            log: `> Form Filling:
  - Data: UK Mobile, UK Address
  - Check: Age >= 18
  - UX: In-chat Form`,
            action: "msg_form"
        },
        {
            phase: "Scene 8: Submission Complete",
            title: "Processing & Ecosystem",
            desc: "Application submitted. AI sets expectation (1-2 days review) but emphasizes digital speed. Family ecosystem locked.",
            log: `> Application Submitted:
  - Status: Under Review
  - SLA: 1-2 Working Days
  - Alerts: Enabled
  - Ecosystem: Activated`,
            action: "msg_finish"
        }
    ];

    let currentStep = 0;

    function nextScene() {
        if (currentStep >= script.length) return;
        
        const data = script[currentStep];
        const panel = document.getElementById('storyPanel');

        // 1. Update Left Panel
        document.querySelectorAll('.scene-card').forEach(c => c.classList.remove('active'));
        const card = document.createElement('div');
        card.className = 'scene-card active';
        card.innerHTML = `
            <div class="scene-header"><span>${data.phase}</span></div>
            <div class="scene-title">${data.title}</div>
            <div class="scene-desc">${data.desc}</div>
            <div class="system-log">${data.log.replace(/\n/g, '<br>')}</div>
        `;
        panel.appendChild(card);
        card.scrollIntoView({behavior: 'smooth'});

        // 2. Simulator Logic
        if (data.action === "show_notif") {
            setTimeout(() => document.getElementById('notif').classList.add('show'), 500);
        }

        if (data.action === "msg_welcome") {
             const body = document.getElementById('chatBody');
             body.innerHTML = ''; // Clean start
             
             addChat("user", "My son in London needs to pay a rent deposit urgently, about ¬£2,000. If I transfer it now, when will he receive it? It's 10 PM here.");
             
             setTimeout(() => addChat("ai", "Ms. Li, please rest assured. Leveraging HSBC's global network, as both you and Leo are Premier customers, using the <strong>Global View Global Transfer (GVGT)</strong> channel, the funds will arrive in Leo's UK HSBC account instantly, with zero cross-border fees. It typically takes a few seconds to a few minutes.<br><br><em>(Screen shows estimated arrival: Immediately / Within minutes)</em>"), 1000);
        }

        if (data.action === "msg_solution") {
            addChat("user", "Really? That's great! I'll transfer it right away.");
            
            setTimeout(() => addChat("ai", `
                <div class="transfer-card">
                    <div class="tc-row">
                        <div class="tc-label">From: CN Savings</div>
                        <div class="tc-amount">¬• 18,450.00</div>
                    </div>
                    <div class="tc-arrow">‚Üì</div>
                    <div class="tc-row">
                        <div class="tc-label">To: Leo Li (UK)</div>
                        <div class="tc-amount">¬£ 2,000.00</div>
                    </div>
                    <div class="tc-info">
                        <span>Rate: 9.225</span>
                        <span class="highlight-text">Fee: ¬£0.00</span>
                    </div>
                    <button class="btn-action" onclick="triggerFaceID()">Confirm Transfer</button>
                </div>
            `), 800);
        }

        if (data.action === "msg_pain") {
            const body = document.getElementById('chatBody');
            const log = document.createElement('div');
            log.style.textAlign = 'center'; log.style.color = '#008a3c'; log.style.fontSize='0.7rem'; log.style.margin='15px';
            log.innerHTML = "‚úì ¬£2,000.00 Transferred Successfully";
            body.appendChild(log);

            setTimeout(() => addChat("user", "That's sorted for now. But he doesn't have a local UK bank card. It's very inconvenient for taking the tube or grocery shopping. He can't carry cash every day, right?"), 1000);
        }

        if (data.action === "msg_upsell") {
            setTimeout(() => addChat("ai", `
                This is a common pain point for international students. You can apply for an <strong>HSBC Premier Supplementary Credit Card</strong> for Leo. While benefits vary by region, typical features include:<br><br>
                1. <strong>Instant Digital Card</strong> ‚Äî Once approved, add immediately to Apple Pay/Google Pay for mobile payments.<br>
                2. <strong>Transaction Alerts & Visibility</strong> ‚Äî As the primary cardholder, you can view all spending details in the App.<br>
                3. <strong>Shared Points</strong> ‚Äî Supplementary card spending accumulates points for the main account.<br><br>
                <span style="font-size:0.75rem; color:#666;">Note: Supplementary cardholder must be over 18, and the primary cardholder is liable for all spending.</span>
            `), 1000);
        }

        if (data.action === "msg_monitoring") {
            addChat("user", "That's excellent! My biggest worry is him overspending. I want to see his spending status anytime. Is this feature real-time?");
            
            setTimeout(() => addChat("ai", "Yes, all supplementary card transactions will appear instantly in your HSBC App. Once approved, he can use Apple Pay on his phone for the tube and shopping in the UK, which is very convenient."), 1500);
            
            setTimeout(() => addChat("user", "Okay, I want to apply! How do I do it?"), 3000);
        }

        if (data.action === "msg_form") {
            setTimeout(() => addChat("ai", `
                I have prepared the application form for you. No income proof required for Leo. Please confirm the following information:
                <div class="form-card">
                    <div class="form-header">Supplementary Card Application</div>
                    <div class="form-group">
                        <label class="form-label">Leo's UK Mobile</label>
                        <input type="text" class="form-input" value="+44 7700 900000">
                    </div>
                    <div class="form-group">
                        <label class="form-label">UK Address</label>
                        <input type="text" class="form-input" value="UCL Hall, London">
                    </div>
                    <div class="form-check">
                        <span>‚òë Confirmed: Leo is over 18</span>
                    </div>
                    <button class="btn-action" onclick="triggerFaceID()">Submit Application</button>
                </div>
            `), 1000);
        }

        if (data.action === "msg_finish") {
             const body = document.getElementById('chatBody');
             const log = document.createElement('div');
             log.style.textAlign = 'center'; log.style.color = '#008a3c'; log.style.fontSize='0.7rem'; log.style.margin='15px';
             log.innerHTML = "‚úì Application Submitted";
             body.appendChild(log);

             addChat("ai", "Thank you for submitting the details. The supplementary card application has been sent for review, typically taking <strong>1‚Äì2 working days</strong>. Once approved, the digital card can be used immediately.<br><br>I have also enabled spending alerts for you to track his expenses in real-time.");
             
             setTimeout(() => addChat("user", "You really thought of everything. I should use HSBC more often."), 2000);
             
             setTimeout(() => addChat("ai", "Our goal is to make your global life seamless. We also provide Global Emergency Support, including emergency cash assistance. Please rest assured."), 3500);
        }

        currentStep++;
        updateButtons();
    }

    function prevScene() {
        if (currentStep <= 0) return;
        
        // Visual Undo
        const panel = document.getElementById('storyPanel');
        if (panel.children.length > 1) panel.lastElementChild.remove();
        const cards = panel.querySelectorAll('.scene-card');
        if (cards.length > 0) cards[cards.length-1].classList.add('active');

        // Chat Undo
        const chatBody = document.getElementById('chatBody');
        if (currentStep > 1) { 
             let count = 0;
             // Remove messages associated with the step
             while (chatBody.lastElementChild && count < 3) {
                 if (chatBody.lastElementChild.classList.contains('bubble-light') && chatBody.lastElementChild.classList.contains('ai') && currentStep === 2) break; // Don't delete Welcome msg if backing from scene 3
                 chatBody.lastElementChild.remove();
                 count++;
             }
        }
        
        if (currentStep === 1) document.getElementById('notif').classList.remove('show');

        currentStep--;
        updateButtons();
    }

    function updateButtons() {
        const nextBtn = document.getElementById('nextBtn');
        const prevBtn = document.getElementById('prevBtn');
        
        nextBtn.innerText = currentStep >= script.length ? "End of Scenario" : (currentStep === 0 ? "Start Scenario" : "Next Scene >");
        nextBtn.disabled = currentStep >= script.length;
        prevBtn.disabled = currentStep <= 0;
    }

    function userClicksNotification() {
        document.getElementById('notif').classList.remove('show');
        if (currentStep === 0) nextScene();
    }

    function triggerFaceID() {
        const overlay = document.getElementById('faceidOverlay');
        overlay.classList.add('show');
        setTimeout(() => {
            overlay.classList.remove('show');
            if (currentStep === 3 || currentStep === 7) nextScene();
        }, 1500);
    }

    function addChat(type, html) {
        const body = document.getElementById('chatBody');
        const div = document.createElement('div');
        div.className = `bubble-light ${type}`;
        div.innerHTML = html;
        body.appendChild(div);
        body.scrollTop = body.scrollHeight;
    }
</script>

</body>
</html>
